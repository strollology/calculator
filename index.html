<!DOCTYPE html>
<html>
<head>
	<title>Fatigue Factor Calculator</title>
	<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
	<h1>Fatigue Factor Calculator</h1>
	<form>
		<label for="test300m">300m Test Time (mm:ss.t):</label>
		<input type="text" id="test300m" name="test300m" placeholder="mm:ss.t">
		<label for="test1_5mile">1.5 Mile Test Time (mm:ss.t):</label>
		<input type="text" id="test1_5mile" name="test1_5mile" placeholder="mm:ss.t">
		<button type="button" id="calculate">Calculate</button>
		<div id="error"></div>
		<div id="result"></div>
		<div id="optimal">Optimal: 20-21%</div>
		<div id="priority"></div>
	</form>
	<script>
	function calculateFatigueFactor() {
		const time300m = document.getElementById("test300m").value;
		const time1_5Mile = document.getElementById("test1_5mile").value;

		const time300mInSeconds = convertTimeToSeconds(time300m);
		const time1_5MileInSeconds = convertTimeToSeconds(time1_5Mile);

		const fatigueFactor = ((Math.log(time1_5MileInSeconds) - Math.log(time300mInSeconds)) / Math.log(1609.34 / 300)) * 100;

		return fatigueFactor.toFixed(2);
	}

	function displayTrainingPriority() {
		const fatigueFactor = calculateFatigueFactor();
		const goal300mTime = calculateGoal300mTime(fatigueFactor);

		const trainingPriority = getTrainingPriority(fatigueFactor);

		document.getElementById("priority").innerHTML = "Training Priority: " + trainingPriority;
		document.getElementById("goal-300m-time").innerHTML = "Goal 300m Time: " + formatTime(goal300mTime);
	}

	function calculateGoal300mTime(fatigueFactor) {
		const twoPointFiveMilesInMeters = 4023.36;
		const threeHundredMetersInMeters = 300;

		const time1_5MileInSeconds = convertTimeToSeconds(document.getElementById("test1_5mile").value);

		const goal300mTimeInSeconds = time1_5MileInSeconds * Math.pow(threeHundredMetersInMeters / (1609 * 1.5), fatigueFactor + 1);

		return goal300mTimeInSeconds;
	}

	function getTrainingPriority(fatigueFactor) {
		const threshold = 0.01;

		if (fatigueFactor >= threshold) {
			return "Endurance";
		} else {
			return "Speed";
		}
	}

	function formatTime(timeInSeconds) {
		const minutes = Math.floor(timeInSeconds / 60);
		const seconds = (timeInSeconds - minutes * 60).toFixed(1);
		return minutes + ":" + (seconds < 10 ? "0" : "") + seconds;
	}

	function convertTimeToSeconds(timeString) {
		const [minutes, seconds] = timeString.split(":");
		return parseInt(minutes) * 60 + parseFloat(seconds);
	}
</script>

</body>
</html>
